<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Agrupamiento y filtrado — 13:07 min &mdash; documentación de Python, Big data, Machine Learning y Cloud Computing - 0.1</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="Redimensionamiento de tablas — 10:31 min" href="2-10_redimensionamiento.html" />
    <link rel="prev" title="Actualización de campos — 7:30 min" href="1-08_actualizacion_de_campos.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> Python, Big data, Machine Learning y Cloud Computing
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Temas:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../handling_data.html">Manipulación de datos usando Python</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../introduccion_a_analitica/intro_analitica.html">Introducción a Analítica</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro_python/introduccion.html">Introducción a Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jupyterlab_colab/herramientas.html">Herramientas del Curso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../control_de_flujo/control_de_flujo.html">Herramientas de Control de Flujo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../estructuras_de_datos/estructuras_de_datos.html">Estructuras de Datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../entrada_salida/entrada_salida.html">Entrada y Salida</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../errores_excepciones/errores_excepciones.html">Manejo de errores y excepciones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ejemplos_analisis_datos/ejemplos_analisis_datos.html">Python: Ejemplos de Análisis de Datos</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../manipulacion_datos.html">Manipulación de Datos con Pandas</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="1-01_estructura_del_dataframe.html">Visualización de la estructura del dataframe — 10:54 min</a></li>
<li class="toctree-l3"><a class="reference internal" href="1-02_seleccion_y_manejo_de_columnas.html">Selección y manejo de columnas — 5:34 min</a></li>
<li class="toctree-l3"><a class="reference internal" href="1-03_seleccion_y_manejo_de_filas.html">Selección y manejo de filas — 5:35 min</a></li>
<li class="toctree-l3"><a class="reference internal" href="1-04_propiedades_loc_iloc_iat.html">Propiedades loc, iloc, at e iat — 5:51 min</a></li>
<li class="toctree-l3"><a class="reference internal" href="1-05_revision_operaciones_basicas.html">Caso práctico — Exportación de un subconjunto de datos — 6:29 min</a></li>
<li class="toctree-l3"><a class="reference internal" href="1-06_concatenacion_y_fusion.html">Concatenacióny fusión de dataframes (concat() y append()) — 11:16 min</a></li>
<li class="toctree-l3"><a class="reference internal" href="1-07_joins.html">Fusión (merging/join) de datasets — 14:56 min</a></li>
<li class="toctree-l3"><a class="reference internal" href="1-08_actualizacion_de_campos.html">Actualización de campos — 7:30 min</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Agrupamiento y filtrado — 13:07 min</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Definición-del-problema">Definición del problema</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Preparación">Preparación</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Creación-de-la-tabla-drivers">Creación de la tabla <code class="docutils literal notranslate"><span class="pre">drivers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Creación-de-la-tabla-timesheet">Creación de la tabla <code class="docutils literal notranslate"><span class="pre">timesheet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Media-de-la-cantidad-de-horas-y-millas-de-cada-conductor-por-año">Media de la cantidad de horas y millas de cada conductor por año</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Registros-con-valores-por-debajo-de-la-media-del-grupo">Registros con valores por debajo de la media del grupo</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Cómputo-de-la-cantidad-de-horas-y-millas-de-cada-conductor-por-año">Cómputo de la cantidad de horas y millas de cada conductor por año</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Unión-de-las-tablas-usando-join">Unión de las tablas usando join</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Almacenamiento-de-los-resultados">Almacenamiento de los resultados</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Ordenamiento-por-la-cantidad-de-millas-registradas">Ordenamiento por la cantidad de millas registradas</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Creación-de-un-gráfico-de-barras-horizontales">Creación de un gráfico de barras horizontales</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Creación-de-un-gráfico-de-barras-verticales">Creación de un gráfico de barras verticales</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="2-10_redimensionamiento.html">Redimensionamiento de tablas — 10:31 min</a></li>
<li class="toctree-l3"><a class="reference internal" href="2-11_analisis_de_datos_con_pandas.html">Análisis de datos usando Pandas — 11:16 min</a></li>
<li class="toctree-l3"><a class="reference internal" href="2-12-comandos_equivalentes_de_SQL_en_pandas.html">Comandos equivalentes de SQL en Pandas — 18:15 min</a></li>
<li class="toctree-l3"><a class="reference internal" href="2-13-python4excel.html">Pandas para usuarios de Microsoft Excel — 19:50 min</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../big_data.html">Big Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../machine_learning.html">Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cloud_computing.html">Cloud Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_visualization.html">Data Visualization</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Python, Big data, Machine Learning y Cloud Computing</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../handling_data.html">Manipulación de datos usando Python</a> &raquo;</li>
          <li><a href="../manipulacion_datos.html">Manipulación de Datos con Pandas</a> &raquo;</li>
      <li>Agrupamiento y filtrado — 13:07 min</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/ciencia_datos/manipulacion_datos/notebooks/2-09_groupby.ipynb.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Agrupamiento-y-filtrado-—-13:07-min">
<h1>Agrupamiento y filtrado — 13:07 min<a class="headerlink" href="#Agrupamiento-y-filtrado-—-13:07-min" title="Enlazar permanentemente con este título"></a></h1>
<ul class="simple">
<li><p>13:07 min | Última modificación: Octubre 6, 2021</p></li>
</ul>
<p>Este tutorial esta basado en <a class="reference external" href="https://es.hortonworks.com/tutorial/how-to-process-data-with-apache-hive/">https://es.hortonworks.com/tutorial/how-to-process-data-with-apache-hive/</a></p>
<section id="Definición-del-problema">
<h2>Definición del problema<a class="headerlink" href="#Definición-del-problema" title="Enlazar permanentemente con este título"></a></h2>
<p>A partir de la información contenida en las siguientes tablas, se desea crear una tabla que resume por cada conductor la suma de la cantidad de millas y horas.</p>
<img alt="drivers" src="../../../_images/drivers.jpg" />
</section>
<section id="Preparación">
<h2>Preparación<a class="headerlink" href="#Preparación" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.notebook_repr_html&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Creación-de-la-tabla-drivers">
<h2>Creación de la tabla <code class="docutils literal notranslate"><span class="pre">drivers</span></code><a class="headerlink" href="#Creación-de-la-tabla-drivers" title="Enlazar permanentemente con este título"></a></h2>
<p>A continuación se crea la tabla <code class="docutils literal notranslate"><span class="pre">drivers</span></code>como un DataFrame de Pandas.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drivers</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/jdvelasq/playground/master/datasets/drivers/drivers.csv&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
    <span class="n">thousands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Se obtiene los primeros cinco registros de la tabla para realizar una inspección rápida de los datos y verificar que los datos fueron cargados correctamente.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drivers</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   driverId               name        ssn                   location  \
0        10  George Vetticaden  621011971         244-4532 Nulla Rd.
1        11     Jamie Engesser  262112338         366-4125 Ac Street
2        12        Paul Coddin  198041975  Ap #622-957 Risus. Street
3        13        Joe Niemiec  139907145        2071 Hendrerit. Ave
4        14         Adis Cesir  820812209        Ap #810-1228 In St.

  certified wage-plan
0         N     miles
1         N     miles
2         Y     hours
3         Y     hours
4         Y     hours
</pre></div></div>
</div>
</section>
<section id="Creación-de-la-tabla-timesheet">
<h2>Creación de la tabla <code class="docutils literal notranslate"><span class="pre">timesheet</span></code><a class="headerlink" href="#Creación-de-la-tabla-timesheet" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timesheet</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/jdvelasq/playground/master/datasets/drivers/timesheet.csv&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
    <span class="n">thousands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">timesheet</span><span class="o">.</span><span class="n">head</span><span class="p">(),</span> <span class="s1">&#39;len: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">timesheet</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   driverId  week  hours-logged  miles-logged
0        10     1            70          3300
1        10     2            70          3300
2        10     3            60          2800
3        10     4            70          3100
4        10     5            70          3200
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;len: 1768&#39;
</pre></div></div>
</div>
</section>
<section id="Media-de-la-cantidad-de-horas-y-millas-de-cada-conductor-por-año">
<h2>Media de la cantidad de horas y millas de cada conductor por año<a class="headerlink" href="#Media-de-la-cantidad-de-horas-y-millas-de-cada-conductor-por-año" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_timesheet</span> <span class="o">=</span> <span class="n">timesheet</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;driverId&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">mean_timesheet</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          week  hours-logged  miles-logged
driverId
10        26.5     62.153846   2829.807692
11        26.5     70.038462   3448.076923
12        26.5     50.750000   2614.653846
13        26.5     52.442308   2579.346154
14        26.5     53.480769   2627.384615
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Eliminación de la columna &#39;week&#39;</span>
<span class="c1">#</span>
<span class="n">mean_timesheet</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;week&#39;</span><span class="p">)</span>
<span class="n">mean_timesheet</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          hours-logged  miles-logged
driverId
10           62.153846   2829.807692
11           70.038462   3448.076923
12           50.750000   2614.653846
13           52.442308   2579.346154
14           53.480769   2627.384615
</pre></div></div>
</div>
</section>
<section id="Registros-con-valores-por-debajo-de-la-media-del-grupo">
<h2>Registros con valores por debajo de la media del grupo<a class="headerlink" href="#Registros-con-valores-por-debajo-de-la-media-del-grupo" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_hours_logged_by_driver</span> <span class="o">=</span> <span class="n">timesheet</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;driverId&quot;</span><span class="p">)[</span><span class="s2">&quot;hours-logged&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
    <span class="s2">&quot;mean&quot;</span>
<span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">mean_hours_logged_by_driver</span><span class="o">.</span><span class="n">head</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">mean_hours_logged_by_driver</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0    62.153846
1    62.153846
2    62.153846
3    62.153846
4    62.153846
Name: hours-logged, dtype: float64
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1768
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timesheet_with_means</span> <span class="o">=</span> <span class="n">timesheet</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">timesheet_with_means</span><span class="p">[</span><span class="s2">&quot;mean_hours-logged&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_hours_logged_by_driver</span>
<span class="n">timesheet_with_means</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   driverId  week  hours-logged  miles-logged  mean_hours-logged
0        10     1            70          3300          62.153846
1        10     2            70          3300          62.153846
2        10     3            60          2800          62.153846
3        10     4            70          3100          62.153846
4        10     5            70          3200          62.153846
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timesheet_below</span> <span class="o">=</span> <span class="n">timesheet_with_means</span><span class="p">[</span>
    <span class="n">timesheet_with_means</span><span class="p">[</span><span class="s2">&quot;hours-logged&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">timesheet_with_means</span><span class="p">[</span><span class="s2">&quot;mean_hours-logged&quot;</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">timesheet_below</span><span class="o">.</span><span class="n">head</span><span class="p">(),</span> <span class="n">timesheet_below</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    driverId  week  hours-logged  miles-logged  mean_hours-logged
2         10     3            60          2800          62.153846
9         10    10            50          2500          62.153846
19        10    20            30          1200          62.153846
20        10    21            50          2500          62.153846
25        10    26            60          2600          62.153846
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
      driverId  week  hours-logged  miles-logged  mean_hours-logged
1756        43    41            51          2701          52.884615
1760        43    45            46          2671          52.884615
1762        43    47            50          2572          52.884615
1763        43    48            52          2517          52.884615
1767        43    52            48          2764          52.884615
</pre></div></div>
</div>
</section>
<section id="Cómputo-de-la-cantidad-de-horas-y-millas-de-cada-conductor-por-año">
<h2>Cómputo de la cantidad de horas y millas de cada conductor por año<a class="headerlink" href="#Cómputo-de-la-cantidad-de-horas-y-millas-de-cada-conductor-por-año" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Suma por grupo de todas las columnas numéricas</span>
<span class="c1">#</span>
<span class="n">sum_timesheet</span> <span class="o">=</span> <span class="n">timesheet</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;driverId&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">sum_timesheet</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          week  hours-logged  miles-logged
driverId
10        1378          3232        147150
11        1378          3642        179300
12        1378          2639        135962
13        1378          2727        134126
14        1378          2781        136624
15        1378          2734        138750
16        1378          2746        137205
17        1378          2701        135992
18        1378          2654        137834
19        1378          2738        137968
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Se elimina la columna week</span>
<span class="c1">#</span>
<span class="n">sum_timesheet</span> <span class="o">=</span> <span class="n">sum_timesheet</span><span class="p">[[</span><span class="s2">&quot;hours-logged&quot;</span><span class="p">,</span> <span class="s2">&quot;miles-logged&quot;</span><span class="p">]]</span>
<span class="n">sum_timesheet</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          hours-logged  miles-logged
driverId
10                3232        147150
11                3642        179300
12                2639        135962
13                2727        134126
14                2781        136624
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Filtrado</span>
<span class="c1">#</span>
<span class="n">timesheet</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;driverId&quot;</span><span class="p">)[</span><span class="s1">&#39;hours-logged&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0       3232
1       3232
2       3232
3       3232
4       3232
        ...
1763    2750
1764    2750
1765    2750
1766    2750
1767    2750
Name: hours-logged, Length: 1768, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timesheet</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;driverId&quot;</span><span class="p">)[</span><span class="s1">&#39;hours-logged&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          min  max
driverId
10          0   76
11          0   92
12          0   60
13         10   60
14         45   60
15         45   60
16         45   60
17         20   60
18         45   60
19         45   60
20          0   60
21         45   60
22         45   60
23         45   60
24          0   60
25         45   60
26         45   60
27         45   60
28         45   60
29         45   60
30         45   60
31         45   60
32         45   60
33         46   60
34         45   60
35         45   60
36         45   60
37         45   59
38         45   60
39         45   60
40         45   60
41         45   60
42         45   60
43         46   60
</pre></div></div>
</div>
</section>
<section id="Unión-de-las-tablas-usando-join">
<h2>Unión de las tablas usando join<a class="headerlink" href="#Unión-de-las-tablas-usando-join" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">sum_timesheet</span><span class="p">,</span>
    <span class="n">drivers</span><span class="p">[[</span><span class="s2">&quot;driverId&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]],</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;driverId&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">summary</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    driverId  hours-logged  miles-logged                 name
0         10          3232        147150    George Vetticaden
1         11          3642        179300       Jamie Engesser
2         12          2639        135962          Paul Coddin
3         13          2727        134126          Joe Niemiec
4         14          2781        136624           Adis Cesir
5         15          2734        138750         Rohit Bakshi
6         16          2746        137205           Tom McCuch
7         17          2701        135992          Eric Mizell
8         18          2654        137834            Grant Liu
9         19          2738        137968           Ajay Singh
10        20          2644        134564         Chris Harris
11        21          2751        138719         Jeff Markham
12        22          2733        137550        Nadeem Asghar
13        23          2750        137980            Adam Diaz
14        24          2647        134461          Don Hilborn
15        25          2723        139180  Jean-Philippe Playe
16        26          2730        137530         Michael Aube
17        27          2771        137922      Mark Lochbihler
18        28          2723        137469      Olivier Renault
19        29          2760        138255           Teddy Choi
20        30          2773        137473             Dan Rice
21        31          2704        137057        Rommel Garcia
22        32          2736        137422       Ryan Templeton
23        33          2759        139285    Sridhara Sabbella
24        34          2811        137728         Frank Romano
25        35          2728        138727          Emil Siemes
26        36          2795        138025        Andrew Grande
27        37          2694        137223            Wes Floyd
28        38          2760        137464           Scott Shaw
29        39          2745        138788         David Kaiser
30        40          2700        136931     Nicolas Maillard
31        41          2723        138407        Greg Phillips
32        42          2697        136673      Randy Gelhausen
33        43          2750        136993          Dave Patton
</pre></div></div>
</div>
</section>
<section id="Almacenamiento-de-los-resultados">
<h2>Almacenamiento de los resultados<a class="headerlink" href="#Almacenamiento-de-los-resultados" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summary</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
    <span class="s1">&#39;/tmp/summary.csv&#39;</span><span class="p">,</span>
    <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span>
    <span class="n">header</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Visualización del contenido del archivo</span>
<span class="c1">#</span>
<span class="o">!</span>head /tmp/summary.csv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
driverId,hours-logged,miles-logged,name
10,3232,147150,George Vetticaden
11,3642,179300,Jamie Engesser
12,2639,135962,Paul Coddin
13,2727,134126,Joe Niemiec
14,2781,136624,Adis Cesir
15,2734,138750,Rohit Bakshi
16,2746,137205,Tom McCuch
17,2701,135992,Eric Mizell
18,2654,137834,Grant Liu
</pre></div></div>
</div>
</section>
<section id="Ordenamiento-por-la-cantidad-de-millas-registradas">
<h2>Ordenamiento por la cantidad de millas registradas<a class="headerlink" href="#Ordenamiento-por-la-cantidad-de-millas-registradas" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top10</span> <span class="o">=</span> <span class="n">summary</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;miles-logged&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">top10</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    driverId  hours-logged  miles-logged                 name
1         11          3642        179300       Jamie Engesser
0         10          3232        147150    George Vetticaden
23        33          2759        139285    Sridhara Sabbella
15        25          2723        139180  Jean-Philippe Playe
29        39          2745        138788         David Kaiser
5         15          2734        138750         Rohit Bakshi
25        35          2728        138727          Emil Siemes
11        21          2751        138719         Jeff Markham
31        41          2723        138407        Greg Phillips
19        29          2760        138255           Teddy Choi
</pre></div></div>
</div>
</section>
<section id="Creación-de-un-gráfico-de-barras-horizontales">
<h2>Creación de un gráfico de barras horizontales<a class="headerlink" href="#Creación-de-un-gráfico-de-barras-horizontales" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># La columna &#39;name&#39; pasa a ser el nombre de las filas</span>
<span class="c1">#</span>
<span class="n">top10</span> <span class="o">=</span> <span class="n">top10</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Paleta de colores:</span>
<span class="c1">#</span>
<span class="c1">#   tab:blue     tab:red       tab:pink</span>
<span class="c1">#   tab:orange   tab:purple    tab:gray</span>
<span class="c1">#   tab:green    tab:brown     tab:olive</span>
<span class="c1">#   tab:cyan</span>
<span class="c1">#</span>
<span class="n">top10</span><span class="p">[</span><span class="s1">&#39;miles-logged&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">90</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/ciencia_datos_manipulacion_datos_notebooks_2-09_groupby_33_0.png" src="../../../_images/ciencia_datos_manipulacion_datos_notebooks_2-09_groupby_33_0.png" />
</div>
</div>
</section>
<section id="Creación-de-un-gráfico-de-barras-verticales">
<h2>Creación de un gráfico de barras verticales<a class="headerlink" href="#Creación-de-un-gráfico-de-barras-verticales" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top10</span><span class="p">[</span><span class="s1">&#39;miles-logged&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;,&#39;</span><span class="p">)))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;lightgray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/ciencia_datos_manipulacion_datos_notebooks_2-09_groupby_35_0.png" src="../../../_images/ciencia_datos_manipulacion_datos_notebooks_2-09_groupby_35_0.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pie de página">
        <a href="1-08_actualizacion_de_campos.html" class="btn btn-neutral float-left" title="Actualización de campos — 7:30 min" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="2-10_redimensionamiento.html" class="btn btn-neutral float-right" title="Redimensionamiento de tablas — 10:31 min" accesskey="n" rel="next">Siguiente <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2022, Santiago Arboleda.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>